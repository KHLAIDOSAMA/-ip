<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>تسجيل IP</title>
</head>
<body>
    <h1 id="status">جاري التحميل...</h1>

    <script>
        function getIP(callback) {
            fetch('https://api.ipify.org?format=json')
                .then(response => response.json())
                .then(data => callback(data.ip))
                .catch(() => callback(null));
        }

        getIP(function (ip) {
            if (ip) {
                document.getElementById("status").textContent = "عنوان IP الخاص بك هو: " + ip;

                // إرسال الـ IP إلى Google Sheet
                fetch('https://script.google.com/macros/s/AKfycbxWR3DWPd8gBOj9naIoQpV9thP-4j928dXOBg2tmMAqyrtIpeXlVX3V4A7S6Si42ICi/exec', {
                    method: 'POST',
                    body: JSON.stringify({ ip: ip }),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => response.text())
                .then(result => console.log('تم الإرسال إلى Google Sheet:', result))
                .catch(error => console.error('خطأ في الإرسال:', error));

            } else {
                document.getElementById("status").textContent = "فشل في جلب عنوان IP.";
            }
        });
    </script>
</body>
</html>
